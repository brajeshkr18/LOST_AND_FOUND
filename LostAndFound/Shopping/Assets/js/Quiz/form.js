var oneminute=60;var lastactionobj="";var user_agent=navigator.userAgent;var is_android=window.is_android;var ie_version=window.ie_version;var may_scroll=window.may_scroll;var calculations_timeout=null;var fields_timeout=null;function obj_size(b){var a=0;for(var c in b){if(b.hasOwnProperty(c)){a++}}return a}function myformsavetimer(){window.fields_timeout=setTimeout("myformsavetimer()",200);if(window.lastactiontime>0){var a=Math.round(new Date().getTime());var b=Math.round((a-window.lastactiontime));if(b<500){}else{window.lastactiontime=0;clearTimeout(window.calculations_timeout);updateformfields_async(false,0);clearTimeout(window.fields_timeout)}}}function updateformfields_async(a,b){calculations_timeout=setTimeout(function(){updateformfields(a,b)},50)}function updateformfields(g,b){lastobj_id=0;if(lastactionobj!=null){if(typeof(lastactionobj)=="object"){lastobj=lastactionobj;if(typeof(lastobj.id)!="undefined"){lastobj_id=lastobj.id}}}if(!calc_fields){return false}if(stopCalculateNow()){window.stopCalculate=false;return false}var l=$.param($('#mainform123 input[type="text"], #mainform123 input[type="checkbox"]:checked, #mainform123 input[type="radio"]:checked, #mainform123 input[type="hidden"], #mainform123 select').not(".excluded-ajax").not(":hidden"));if(stopCalculateNow()){window.stopCalculate=false;return false}if($('input[name="language"]').length>0){lang=$('input[name="language"]').val();l+="&usedlang="+lang}var m=$(".fieldcontainer.currentPageInactive, .fieldcontainer.class123-hidden, .fieldcontainer.currentPageActive");var h=m.length;var f="";var c="";if(h>0){for(var d=0;d<h;d++){if(stopCalculateNow()){window.stopCalculate=false;return false}var a=m.eq(d);var e=a.attr("style");if(e==undefined){e=""}if(!a.hasClass("currentPageActive")){if(((e.indexOf("display: none")==-1))||(a.hasClass("class123-hidden"))){inputs=a.find('input[type="text"], input[type="checkbox"]:checked, input[type="radio"]:checked, select').not(".excluded-ajax");c=$.param(inputs);f+="&"+c}}else{if((a.hasClass("class123-hidden"))||(a.hasClass("class123-readonly-field"))){inputs=a.find('input[type="text"],input[type="checkbox"]:checked, input[type="radio"]:checked');c=$.param(inputs);f+="&"+c}if((e.indexOf("display: none")==-1)&&(a.find(".searchable").length>0)){inputs=a.find("select.searchable").not(".excluded-ajax");c=$.param(inputs);f+="&"+c}}if(a.hasClass("force-calc")){inputs=a.find('input[type="text"]:hidden');c=$.param(inputs);f+="&"+c}}}if($(".stars-rate").length>0){inputs=$(".stars-rate").parent().find('input[type="hidden"]');c=$.param(inputs);f+="&"+c}if($("#id123-couponcode").length>0){if(f.indexOf("couponcode")==-1){f+="&couponcode="+$("#id123-couponcode").val()}}if(this.form_is_quiz){f+="&form_is_quiz=1"}var k="";if($("#hiddenfields").length>0){k=$("#hiddenfields").val()}var j="";if(stopCalculateNow()){window.stopCalculate=false;return false}if($("#instance").length>0){j=$("#instance").val()}$.ajax({url:"/ajax_form.php?modulename=sf_calc_actions.php",data:"someaction=get_result&f_id="+fid+"&only_summary="+g+"&curr="+curr+"&"+l+f+"&hiddenfields="+k+"&instance="+j,type:"POST",async:true,dataType:"text",cache:false,success:function(z){if(stopCalculateNow()){window.stopCalculate=false;return false}var p=$.parseJSON(z);var q=obj_size(p);if(q>0){var u="";var i=0;var w=0;if($("#id123-total-pay").length>0){$("#id123-total-pay").val(p.total_val)}if($("#id123-control000001").length>0){$("#id123-control000001").val(p.quiz_total)}if(p.form!=undefined){var y=obj_size(p.form)}else{y=0}if((document.getElementById("realtime-summary")!=undefined)||(document.getElementById("offline-form-summary")!=undefined)){if(p.summary!=undefined){u+=p.summary;form_total=p.total;i=p.total_val;w=p.subtotal_val}}if(y>0){var r=p.form;for(key in r){if(stopCalculateNow()){window.stopCalculate=false;return false}val=r[key].toString();if(document.getElementById("id123-control"+key)!=undefined){if(document.getElementById("id123-control"+key).id!=lastobj_id){var n=document.getElementById("id123-control"+key);var t=n.parentNode.parentNode.parentNode;var x=n.parentNode;var o=getElementsByClassName(x,"p","fielderror");if(val.indexOf("error")==-1){n.value=val;if(o.length==0){t.style.background=""}}else{n.value="";t.style.background="#FFDFDF";vals=val.split("||");var v='<div class="clear"></div><p class="fielderror calculation-error" style="padding: 0px; margin: 0px; color: red; font-weight: bold; ">'+vals[1]+"</p>"}var o=getElementsByClassName(x,"p","fielderror");if(o.length>0){for(d=0;d<o.length;d++){if(stopCalculateNow()){window.stopCalculate=false;return false}if($(o[d]).hasClass("calculation-error")){x.removeChild(o[d])}}}if(val.indexOf("error")!=-1){x.innerHTML+=v}}}}}else{$("input.with-formula").val("")}var s=0;if($("#id123-self-fid").length>0){if(($("#id123-self-fid").val()==1432849)||($("#id123-self-fid").val()==1470770)||($("#id123-self-fid").val()==1473556)){s=1000}}if(q<60){InputRules2("calculation",0,s)}$("#id123-button-send").attr("disabled",false);if(b<32){if($("#hiddenfields").val()!=k){}else{if(g){$("#offline-form-summary").html(u);$("#offline-form-summary").show();$("html").animate({scrollTop:$("#offline-form-summary").offset().top-30},400);if(u.length>0){if(!$("#offline-form-summary").hasClass("visible")){$("#offline-form-summary").addClass("visible")}}else{if($("#offline-form-summary").hasClass("visible")){$("#offline-form-summary").removeClass("visible")}}}else{if(w!=0){if(document.getElementById("realtime-summary")!=undefined){document.getElementById("realtime-summary").innerHTML=""+u+""}if(document.getElementById("form-total")!=undefined){document.getElementById("form-total").innerHTML=""+form_total+""}if($("#form-summary").hasClass("hidden")){$("#form-summary").removeClass("hidden")}}else{if(!$("#form-summary").hasClass("hidden")){$("#form-summary").addClass("hidden")}}if(is_android==true){if($("#realtime-summary").length>0){$("#realtime-summary").find("#summary-body").css({overflow:"visible"})}else{if(may_scroll){$("#realtime-summary").find("#summary-body").css({maxHeight:summary_max_height})}}}if($("#realtime-summary").find("#summary-body").hasScrollBar()){var A=$("#summary-body-table");A.css("width",(A.width()+18)+"px");$("#form-total").css("text-indent",-16);$("#realtime-summary").find("#summary-body").width($("#form-summary").width())}}}}if((may_scroll)&&(real_time)){init_real_time_toolbar();scroll_real_time_toolbar()}}if(b<32){if($("#hiddenfields").val()!=k){updateformfields(g,b+1)}}if(typeof(fid)!="undefined"){if(fid=="1556438"){if(b==0){updateformfields(g,b+1)}}}if(g){RefreshFrameHeight(0)}}})}(function(a){a.fn.hasScrollBar=function(){if(this.get(0)!=undefined){return(this.get(0).scrollHeight-1)>this.height()}}})(jQuery);function getElementsByClassName(b,f,a){var e=(f=="*"&&b.all)?b.all:b.getElementsByTagName(f);var h=new Array();a=a.replace(/\-/g,"\\-");var g=new RegExp("(^|\\s)"+a+"(\\s|$)");var d;for(var c=0;c<e.length;c++){d=e[c];if(g.test(d.className)){h.push(d)}}return(h)}myformsavetimer();